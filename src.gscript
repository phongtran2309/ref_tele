{"$type":"GPMAutomateEditor.Models.Editor, GPMAutomateEditor.Models","before_init":{"$type":"GPMAutomateEditor.Models.NormalBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"","delay":"0,0","id":"6a9cdfd0-3bd0-4e14-bf80-8cdd8ccc6dd0","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"Lưu ý trước khi sử dụng ta cần làm các bước sau\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Lưu ý trước khi sử dụng"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"","delay":"0,0","id":"f7d27569-fca1-4acb-b7b3-8cab6f575703","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"Bước 1: mở regedit.exe (window + R)\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Bước 1: mở regedit.exe (window + R)"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"7a09b05b-4176-4361-ada2-aa2259d0400c","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"Bước 2: trong regedit mở đường dẫn Computer\\\\HKEY_CLASSES_ROOT\\\\tg\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Bước 2: trong regedit mở đường dẫn Computer\\HKEY_CLASSES_ROOT\\tg"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"2cd13be2-691b-4111-b8e1-77bc4845ce4d","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"Bước 3: Ở phần bên phải thay \\\"URL Protocol\\\" thành \\\"URL Protocol1\\\" \"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Bước 3: Ở phần bên phải thay \"URL Protocol\" thành \"URL Protocol1\" "},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"botLink","delay":"0,0","id":"654ff441-bfd9-4437-8d7d-67b9656d9da7","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Nhập bot link ref"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"fileName","delay":"0,0","id":"6f450933-b159-4ac4-b093-f59e059555f2","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Nhập tên file data excel"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"delay_close","delay":"0,0","id":"2a449993-5017-457e-838b-8b9948310028","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Nhập số giây chờ đóng proflie để nhận ref"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"file_path","delay":"0,0","id":"6a5456e6-22ce-40cc-84fb-d5f9a42f84f6","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Nhập đường dẫn thư mục lưu file"}],"expanded":true,"id":"463ea7e2-b951-4b50-9ca7-d5a565a9262c","display_text":null,"raw_input":null,"comment":"Before browser opened"},"main_logic":{"$type":"GPMAutomateEditor.Models.NormalBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":39,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"b12403a6-bf85-4fe0-baf6-c1168da304d2","display_text":null,"raw_input":"[{\"Key\":\"URL\",\"Value\":\"$botLink\"}]","comment":"Truy cập link ref"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":68,"element_xpath":null,"output_variable_name":"href","delay":"0,0","id":"d77a1051-6ed0-416b-90d0-3efc6a46f119","display_text":null,"raw_input":"[{\"Key\":\"FILE_OR_CODE\",\"Value\":\"function myFunction() {\\r\\n    // Sử dụng XPath để tìm phần tử với class chứa \\\"tgme_action_web_button\\\"\\r\\n    let element = document.evaluate('//a[contains(@class,\\\"tgme_action_web_button\\\")]', document, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;\\r\\n\\r\\n    // Kiểm tra nếu phần tử tồn tại và lấy thuộc tính href\\r\\n    if (element) {\\r\\n        let href = element.getAttribute(\\\"href\\\");\\r\\n\\r\\n        // Kiểm tra nếu href chứa \\\"/a\\\" và thay thế bằng \\\"/k\\\"\\r\\n        if (href.includes(\\\"https://web.telegram.org/a/\\\")) {\\r\\n            href = href.replace(\\\"https://web.telegram.org/a/\\\", \\\"https://web.telegram.org/k/\\\");\\r\\n        }\\r\\n        console.log(\\\"Link mới:\\\", href);\\r\\n\\r\\n        // Mở đường link mới trong cửa sổ hiện tại\\r\\n        window.open(href, '_self');\\r\\n        return href;\\r\\n    } else {\\r\\n        console.log(\\\"Không tìm thấy phần tử\\\");\\r\\n        return null;\\r\\n    }\\r\\n}\\r\\n\\r\\n// Gọi hàm\\r\\nmyFunction();\"}]","comment":"chuyển link /a thành /k"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":44,"element_xpath":"//div[@class='popup popup-peer popup-confirmation active']","output_variable_name":null,"delay":"0,0","id":"f7be6ac4-7fa1-4cab-9b93-c41c2a0dedd9","display_text":null,"raw_input":"[{\"Key\":\"TIME_OUT\",\"Value\":\"30\"}]","comment":"Chờ load bot"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":48,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"f88dc750-74ba-456c-8e39-512f1b182f4f","display_text":null,"raw_input":"[{\"Key\":\"CLICK_TYPE\",\"Value\":\"CLICK_XPATH\"},{\"Key\":\"XPATH\",\"Value\":\"//div[contains(@class, 'popup popup-peer popup-confirmation active')]//button[contains(@class, 'popup-button btn primary')]\"},{\"Key\":\"POS\",\"Value\":\"\"}]","comment":"Click comfirm mở bot"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":7,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"cfa2611c-95b8-45e8-b23c-79b45e62cdcf","display_text":null,"raw_input":"[{\"Key\":\"MIN\",\"Value\":\"1000\"},{\"Key\":\"MAX\",\"Value\":\"2000\"}]","comment":"Dừng chờ sau khi bấm mở bot"},{"$type":"GPMAutomateEditor.Models.IfBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":48,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"9d1d5f08-56cd-41c2-a8a7-2bc3c159306e","display_text":null,"raw_input":"[{\"Key\":\"CLICK_TYPE\",\"Value\":\"CLICK_XPATH\"},{\"Key\":\"XPATH\",\"Value\":\"//div[contains(@class, 'popup popup-peer popup-confirmation active')]//button[contains(@class, 'popup-button btn primary')]\"},{\"Key\":\"POS\",\"Value\":\"\"}]","comment":"Click confirm mở bot"}],"expanded":true,"id":"0f4b594d-123a-41f7-8558-699a5bdd04b4","display_text":null,"raw_input":"[{\"Key\":\"CONDITION\",\"Value\":\"hasElement(//div[@class='popup popup-peer popup-confirmation active'])\"}]","comment":"Kiểm tra xem mở bot được chưa"},{"$type":"GPMAutomateEditor.Models.ElseBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":44,"element_xpath":"//iframe[@class=\"payment-verification\"]","output_variable_name":null,"delay":"0,0","id":"52de36a4-3ffe-489e-a835-623d4e81edea","display_text":null,"raw_input":"[{\"Key\":\"TIME_OUT\",\"Value\":\"20\"}]","comment":"Chờ iframe hiện lên"}],"expanded":true,"id":"64e45b4d-489c-4ab2-b152-b6d8cfb6be78","display_text":null,"raw_input":"[]","comment":"Nếu mở rồi thì chờ load iframe"},{"$type":"GPMAutomateEditor.Models.NormalBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":45,"element_xpath":"//iframe[@class=\"payment-verification\"]","output_variable_name":"src","delay":"0,0","id":"ab612f41-7e4d-4f89-b3cd-ba7eceea9ebb","display_text":null,"raw_input":"[{\"Key\":\"ATTR_NAME\",\"Value\":\"src\"}]","comment":"Lấy src của iframe"}],"expanded":true,"id":"1eab7768-7d4e-44f3-a277-109619995c34","display_text":null,"raw_input":"[]","comment":"Lấy iframe"},{"$type":"GPMAutomateEditor.Models.NormalBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":68,"element_xpath":null,"output_variable_name":"querry_id","delay":"0,0","id":"c2ad4175-ab16-4f85-85ae-eaaa49aef201","display_text":null,"raw_input":"[{\"Key\":\"FILE_OR_CODE\",\"Value\":\"const game = document.querySelector('iframe'); const src = game.getAttribute('src'); const startIndex = src.indexOf('#tgWebAppData=') + '#tgWebAppData='.length; const endIndex = src.indexOf('&', startIndex); const query_id = src.substring(startIndex, endIndex); return decodeURIComponent(query_id)\"}]","comment":"get querry_id"}],"expanded":true,"id":"4f364cf7-4f19-41de-9302-57902f0574cd","display_text":null,"raw_input":"[]","comment":"Xử lý decode lấy querry id"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":7,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"bf9d4cd6-9f70-4a27-bb91-0fe9cf6daa80","display_text":null,"raw_input":"[{\"Key\":\"MIN\",\"Value\":\"$delay_close\"},{\"Key\":\"MAX\",\"Value\":\"$delay_close\"}]","comment":"Chờ đóng app "}],"expanded":true,"id":"3e2990f4-a47e-4c3d-a77e-08686c4b7dd1","display_text":null,"raw_input":null,"comment":"Main logic"},"after_quit":{"$type":"GPMAutomateEditor.Models.NormalBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":74,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"786e985a-da56-47dc-aae6-c8d3e4c40a7d","display_text":null,"raw_input":"[{\"Key\":\"FILE_PATH\",\"Value\":\"D:\\\\Query_id\\\\$fileName.xlsx\"}]","comment":"Tạo file excel"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":71,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"b072386b-46fb-419e-9ec7-2060bf6708ea","display_text":null,"raw_input":"[{\"Key\":\"FILE_PATH\",\"Value\":\"D:\\\\Query_id\\\\$fileName.xlsx\"},{\"Key\":\"SHEET_ID\",\"Value\":\"0\"},{\"Key\":\"COL_NAME_OR_INDEX\",\"Value\":\"A\"},{\"Key\":\"DATA\",\"Value\":\"$profileName\"}]","comment":"Ghi profile name"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":71,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"d4ac2423-96cb-43f4-97d6-f8cf36249700","display_text":null,"raw_input":"[{\"Key\":\"FILE_PATH\",\"Value\":\"D:\\\\Query_id\\\\$fileName.xlsx\"},{\"Key\":\"SHEET_ID\",\"Value\":\"0\"},{\"Key\":\"COL_NAME_OR_INDEX\",\"Value\":\"B\"},{\"Key\":\"DATA\",\"Value\":\"$src\"}]","comment":"Ghi src app"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":71,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"b0eeb305-2b4d-4471-b313-46d4899d9387","display_text":null,"raw_input":"[{\"Key\":\"FILE_PATH\",\"Value\":\"D:\\\\Query_id\\\\$fileName.xlsx\"},{\"Key\":\"SHEET_ID\",\"Value\":\"0\"},{\"Key\":\"COL_NAME_OR_INDEX\",\"Value\":\"C\"},{\"Key\":\"DATA\",\"Value\":\"$querry_id\"}]","comment":"Ghi querry_id"}],"expanded":true,"id":"01dbe1c4-bdf9-4843-ad06-b8ba726b2153","display_text":null,"raw_input":null,"comment":"After browser closed"}}