{"$type":"GPMAutomateEditor.Models.Editor, GPMAutomateEditor.Models","before_init":{"$type":"GPMAutomateEditor.Models.NormalBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"","delay":"0,0","id":"565078a6-e30c-4566-9da9-6de41a8e6824","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"Lưu ý trước khi sử dụng ta cần làm các bước sau\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Lưu ý trước khi sử dụng"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"","delay":"0,0","id":"1a10ffd9-6c0e-4809-aa10-b7f1571f95f0","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"Bước 1: mở regedit.exe (window + R)\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Bước 1: mở regedit.exe (window + R)"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"fecb3131-97b7-4d63-a94e-05d9d9c39321","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"Bước 2: trong regedit mở đường dẫn Computer\\\\HKEY_CLASSES_ROOT\\\\tg\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Bước 2: trong regedit mở đường dẫn Computer\\HKEY_CLASSES_ROOT\\tg"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"ff58d11a-0095-41bc-9fe4-bef56288b40b","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"Bước 3: Ở phần bên phải thay \\\"URL Protocol\\\" thành \\\"URL Protocol1\\\" \"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Bước 3: Ở phần bên phải thay \"URL Protocol\" thành \"URL Protocol1\" "},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"botLink","delay":"0,0","id":"a98bfba0-6f39-44e5-a010-479b7f1813bc","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Nhập bot link ref"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"fileName","delay":"0,0","id":"2b85ab1e-8fd1-4cb6-b3af-144171ddbbc2","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Nhập tên file data excel"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"delay_close","delay":"0,0","id":"8a901097-afae-4aab-8c66-445be332af0a","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Nhập số giây chờ đóng proflie để nhận ref"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"file_path","delay":"0,0","id":"a301cbf5-ba8f-41ba-8ecc-ea941b5b2135","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Nhập đường dẫn thư mục lưu file"}],"expanded":true,"id":"72c73161-6298-4a71-b8b5-be9928788800","display_text":null,"raw_input":null,"comment":"Before browser opened"},"main_logic":{"$type":"GPMAutomateEditor.Models.NormalBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":39,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"fbe2ec9f-aa77-4518-b705-84ca20a7b767","display_text":null,"raw_input":"[{\"Key\":\"URL\",\"Value\":\"$botLink\"}]","comment":"Truy cập link ref"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":45,"element_xpath":"//a[contains(@class,\"tgme_action_web_button\")]","output_variable_name":"href","delay":"0,0","id":"bc9936f2-d5a0-4f5c-a4fd-faafcdcbd71f","display_text":null,"raw_input":"[{\"Key\":\"ATTR_NAME\",\"Value\":\"href\"}]","comment":"Lấy link truy cập bot"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":39,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"53770ff8-53e3-4916-82b5-b028f5b8386e","display_text":null,"raw_input":"[{\"Key\":\"URL\",\"Value\":\"$href\"}]","comment":"Truy cập vào bot telegram"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":44,"element_xpath":"//div[@class='popup popup-peer popup-confirmation active']","output_variable_name":null,"delay":"0,0","id":"07b5f6c3-d267-4e29-9771-e28c764fdc25","display_text":null,"raw_input":"[{\"Key\":\"TIME_OUT\",\"Value\":\"30\"}]","comment":"Chờ load bot"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":48,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"0344b111-f19d-44a1-8b0a-92883b212c92","display_text":null,"raw_input":"[{\"Key\":\"CLICK_TYPE\",\"Value\":\"CLICK_XPATH\"},{\"Key\":\"XPATH\",\"Value\":\"//div[contains(@class, 'popup popup-peer popup-confirmation active')]//button[contains(@class, 'popup-button btn primary')]\"},{\"Key\":\"POS\",\"Value\":\"\"}]","comment":"Click comfirm mở bot"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":7,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"2e350c82-b3d3-4f63-96d4-3a6f30cef41e","display_text":null,"raw_input":"[{\"Key\":\"MIN\",\"Value\":\"1000\"},{\"Key\":\"MAX\",\"Value\":\"2000\"}]","comment":"Dừng chờ sau khi bấm mở bot"},{"$type":"GPMAutomateEditor.Models.IfBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":48,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"68d016f0-a8c0-4523-8bff-7f3182569d92","display_text":null,"raw_input":"[{\"Key\":\"CLICK_TYPE\",\"Value\":\"CLICK_XPATH\"},{\"Key\":\"XPATH\",\"Value\":\"//div[contains(@class, 'popup popup-peer popup-confirmation active')]//button[contains(@class, 'popup-button btn primary')]\"},{\"Key\":\"POS\",\"Value\":\"\"}]","comment":"Click confirm mở bot"}],"expanded":true,"id":"d83fd4ab-aa62-4485-83fc-f0bbba127380","display_text":null,"raw_input":"[{\"Key\":\"CONDITION\",\"Value\":\"hasElement(//div[@class='popup popup-peer popup-confirmation active'])\"}]","comment":"Kiểm tra xem mở bot được chưa"},{"$type":"GPMAutomateEditor.Models.ElseBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":44,"element_xpath":"//iframe[@class=\"payment-verification\"]","output_variable_name":null,"delay":"0,0","id":"1c83599b-d778-4ffd-a055-9989d3f1bb46","display_text":null,"raw_input":"[{\"Key\":\"TIME_OUT\",\"Value\":\"20\"}]","comment":"Chờ iframe hiện lên"}],"expanded":true,"id":"e456453a-2a5a-4d47-a1e4-e9f234c894ba","display_text":null,"raw_input":"[]","comment":"Nếu mở rồi thì chờ load iframe"},{"$type":"GPMAutomateEditor.Models.NormalBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":45,"element_xpath":"//iframe[@class=\"payment-verification\"]","output_variable_name":"src","delay":"0,0","id":"619488da-4d89-403e-b6ce-b124f2dff5e4","display_text":null,"raw_input":"[{\"Key\":\"ATTR_NAME\",\"Value\":\"src\"}]","comment":"Lấy src của iframe"}],"expanded":true,"id":"13d49707-7a4d-4f38-865b-8e848f866b62","display_text":null,"raw_input":"[]","comment":"Lấy iframe"},{"$type":"GPMAutomateEditor.Models.NormalBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":68,"element_xpath":null,"output_variable_name":"querry_id","delay":"0,0","id":"691b5ecd-49ec-47c3-8335-c9b66366a3f2","display_text":null,"raw_input":"[{\"Key\":\"FILE_OR_CODE\",\"Value\":\"const game = document.querySelector('iframe'); const src = game.getAttribute('src'); const startIndex = src.indexOf('#tgWebAppData=') + '#tgWebAppData='.length; const endIndex = src.indexOf('&', startIndex); const query_id = src.substring(startIndex, endIndex); return decodeURIComponent(query_id)\"}]","comment":"get querry_id"}],"expanded":true,"id":"2adae889-daf4-4122-9990-e516dc3e1647","display_text":null,"raw_input":"[]","comment":"Xử lý decode lấy querry id"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":7,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"b3f88f7f-a4f4-4741-bdf4-3591ff3434f3","display_text":null,"raw_input":"[{\"Key\":\"MIN\",\"Value\":\"$delay_close\"},{\"Key\":\"MAX\",\"Value\":\"$delay_close\"}]","comment":"Chờ đóng app "}],"expanded":true,"id":"f6745429-083e-4c3e-bcaf-d6d65ec71362","display_text":null,"raw_input":null,"comment":"Main logic"},"after_quit":{"$type":"GPMAutomateEditor.Models.NormalBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":74,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"590b07e0-1d0c-4127-a0ee-40bd444ad61e","display_text":null,"raw_input":"[{\"Key\":\"FILE_PATH\",\"Value\":\"D:\\\\Query_id\\\\$fileName.xlsx\"}]","comment":"Tạo file excel"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":71,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"dd968454-32f6-475b-a902-050a2b401212","display_text":null,"raw_input":"[{\"Key\":\"FILE_PATH\",\"Value\":\"D:\\\\Query_id\\\\$fileName.xlsx\"},{\"Key\":\"SHEET_ID\",\"Value\":\"0\"},{\"Key\":\"COL_NAME_OR_INDEX\",\"Value\":\"A\"},{\"Key\":\"DATA\",\"Value\":\"$profileName\"}]","comment":"Ghi profile name"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":71,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"ec1958a2-5647-4a31-bc3c-1919e7f88567","display_text":null,"raw_input":"[{\"Key\":\"FILE_PATH\",\"Value\":\"D:\\\\Query_id\\\\$fileName.xlsx\"},{\"Key\":\"SHEET_ID\",\"Value\":\"0\"},{\"Key\":\"COL_NAME_OR_INDEX\",\"Value\":\"B\"},{\"Key\":\"DATA\",\"Value\":\"$src\"}]","comment":"Ghi src app"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":71,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"0d708681-7774-489e-9cc7-ddc90838aa6b","display_text":null,"raw_input":"[{\"Key\":\"FILE_PATH\",\"Value\":\"D:\\\\Query_id\\\\$fileName.xlsx\"},{\"Key\":\"SHEET_ID\",\"Value\":\"0\"},{\"Key\":\"COL_NAME_OR_INDEX\",\"Value\":\"C\"},{\"Key\":\"DATA\",\"Value\":\"$querry_id\"}]","comment":"Ghi querry_id"}],"expanded":true,"id":"74406201-9e30-4566-b768-9522a00c5117","display_text":null,"raw_input":null,"comment":"After browser closed"}}