{"$type":"GPMAutomateEditor.Models.Editor, GPMAutomateEditor.Models","before_init":{"$type":"GPMAutomateEditor.Models.NormalBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"","delay":"0,0","id":"a4fb65d3-e795-42d9-a2ff-81115f25df18","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"Lưu ý trước khi sử dụng ta cần làm các bước sau\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Lưu ý trước khi sử dụng"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"","delay":"0,0","id":"e651cb3d-a2e2-4c04-8187-e30103e57840","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"Bước 1: mở regedit.exe (window + R)\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Bước 1: mở regedit.exe (window + R)"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"80bc1ea4-a9cf-4b18-9193-eb7046e9f629","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"Bước 2: trong regedit mở đường dẫn Computer\\\\HKEY_CLASSES_ROOT\\\\tg\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Bước 2: trong regedit mở đường dẫn Computer\\HKEY_CLASSES_ROOT\\tg"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"d62ed249-2802-4eb3-bb7d-7f3332344282","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"Bước 3: Ở phần bên phải thay \\\"URL Protocol\\\" thành \\\"URL Protocol1\\\" \"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Bước 3: Ở phần bên phải thay \"URL Protocol\" thành \"URL Protocol1\" "},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"botLink","delay":"0,0","id":"706a7c43-1796-4ba7-bc2d-a41a4583d6c6","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Nhập bot link ref"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"fileName","delay":"0,0","id":"eef647be-c7dd-4a69-b3cf-f486b7fdff57","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Nhập tên file data excel"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"delay_close","delay":"0,0","id":"e2a694e0-fc0d-4908-a265-3adc2706e2cb","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Nhập số giây chờ đóng proflie để nhận ref"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":1,"element_xpath":null,"output_variable_name":"file_path","delay":"0,0","id":"cb4db2d1-714b-4b56-8a1c-8d2b8178b482","display_text":null,"raw_input":"[{\"Key\":\"VALUE\",\"Value\":\"\"},{\"Key\":\"ALLOW_USER_INPUT\",\"Value\":\"True\"},{\"Key\":\"USER_INPUT_TYPE\",\"Value\":\"Text\"}]","comment":"Nhập đường dẫn thư mục lưu file"}],"expanded":true,"id":"23dd0d40-bb6c-4a1d-8edc-743240158d34","display_text":null,"raw_input":null,"comment":"Before browser opened"},"main_logic":{"$type":"GPMAutomateEditor.Models.NormalBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":39,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"b22ff9ad-9c1c-4a7f-bec0-d3fe0b9368c2","display_text":null,"raw_input":"[{\"Key\":\"URL\",\"Value\":\"$botLink\"}]","comment":"Truy cập link ref"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":45,"element_xpath":"//a[contains(@class,\"tgme_action_web_button\")]","output_variable_name":"href","delay":"0,0","id":"eb4830e2-292a-4d14-8212-0fc0b1dcc60e","display_text":null,"raw_input":"[{\"Key\":\"ATTR_NAME\",\"Value\":\"href\"}]","comment":"Lấy link truy cập bot"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":68,"element_xpath":null,"output_variable_name":"Link truy cập bot telegram","delay":"0,0","id":"a5c0be41-7ebe-427b-8642-35df278843ff","display_text":null,"raw_input":null,"comment":"chuyển link /a thành /k"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":39,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"0c88c136-5c9b-433a-b303-14b27d67a8f8","display_text":null,"raw_input":"[{\"Key\":\"URL\",\"Value\":\"$href\"}]","comment":"Truy cập vào bot telegram"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":44,"element_xpath":"//div[@class='popup popup-peer popup-confirmation active']","output_variable_name":null,"delay":"0,0","id":"ab4e6a6d-4b18-426f-9b16-426e2eda6b78","display_text":null,"raw_input":"[{\"Key\":\"TIME_OUT\",\"Value\":\"30\"}]","comment":"Chờ load bot"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":48,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"f0a567ae-c27f-4614-bb58-8b2b0f9f08c6","display_text":null,"raw_input":"[{\"Key\":\"CLICK_TYPE\",\"Value\":\"CLICK_XPATH\"},{\"Key\":\"XPATH\",\"Value\":\"//div[contains(@class, 'popup popup-peer popup-confirmation active')]//button[contains(@class, 'popup-button btn primary')]\"},{\"Key\":\"POS\",\"Value\":\"\"}]","comment":"Click comfirm mở bot"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":7,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"7864262e-bbd7-497a-b49a-94f1673965e7","display_text":null,"raw_input":"[{\"Key\":\"MIN\",\"Value\":\"1000\"},{\"Key\":\"MAX\",\"Value\":\"2000\"}]","comment":"Dừng chờ sau khi bấm mở bot"},{"$type":"GPMAutomateEditor.Models.IfBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":48,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"84095d4b-9568-4102-b779-b257a4fb3924","display_text":null,"raw_input":"[{\"Key\":\"CLICK_TYPE\",\"Value\":\"CLICK_XPATH\"},{\"Key\":\"XPATH\",\"Value\":\"//div[contains(@class, 'popup popup-peer popup-confirmation active')]//button[contains(@class, 'popup-button btn primary')]\"},{\"Key\":\"POS\",\"Value\":\"\"}]","comment":"Click confirm mở bot"}],"expanded":true,"id":"60cfdde0-0e47-4744-82f6-ab5009bf4a5c","display_text":null,"raw_input":"[{\"Key\":\"CONDITION\",\"Value\":\"hasElement(//div[@class='popup popup-peer popup-confirmation active'])\"}]","comment":"Kiểm tra xem mở bot được chưa"},{"$type":"GPMAutomateEditor.Models.ElseBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":44,"element_xpath":"//iframe[@class=\"payment-verification\"]","output_variable_name":null,"delay":"0,0","id":"8ee5da90-62a3-4d27-b6f2-d7cdbce3d469","display_text":null,"raw_input":"[{\"Key\":\"TIME_OUT\",\"Value\":\"20\"}]","comment":"Chờ iframe hiện lên"}],"expanded":true,"id":"0159d07b-d617-4428-b9bb-777cfff82649","display_text":null,"raw_input":"[]","comment":"Nếu mở rồi thì chờ load iframe"},{"$type":"GPMAutomateEditor.Models.NormalBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":45,"element_xpath":"//iframe[@class=\"payment-verification\"]","output_variable_name":"src","delay":"0,0","id":"832aac06-9271-4707-bc4b-966e8a519880","display_text":null,"raw_input":"[{\"Key\":\"ATTR_NAME\",\"Value\":\"src\"}]","comment":"Lấy src của iframe"}],"expanded":true,"id":"adeb2ba4-7d0e-4ea2-ada4-63764d36f854","display_text":null,"raw_input":"[]","comment":"Lấy iframe"},{"$type":"GPMAutomateEditor.Models.NormalBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":68,"element_xpath":null,"output_variable_name":"querry_id","delay":"0,0","id":"f7566204-4091-4f5f-93c8-dceea5c29735","display_text":null,"raw_input":"[{\"Key\":\"FILE_OR_CODE\",\"Value\":\"const game = document.querySelector('iframe'); const src = game.getAttribute('src'); const startIndex = src.indexOf('#tgWebAppData=') + '#tgWebAppData='.length; const endIndex = src.indexOf('&', startIndex); const query_id = src.substring(startIndex, endIndex); return decodeURIComponent(query_id)\"}]","comment":"get querry_id"}],"expanded":true,"id":"09365052-33a0-4684-8e76-9f440079b733","display_text":null,"raw_input":"[]","comment":"Xử lý decode lấy querry id"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":7,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"e1dc58b5-6ff5-4996-a7e8-15f56c7311d6","display_text":null,"raw_input":"[{\"Key\":\"MIN\",\"Value\":\"$delay_close\"},{\"Key\":\"MAX\",\"Value\":\"$delay_close\"}]","comment":"Chờ đóng app "}],"expanded":true,"id":"5ac69295-806f-459b-8fda-3ef88b236508","display_text":null,"raw_input":null,"comment":"Main logic"},"after_quit":{"$type":"GPMAutomateEditor.Models.NormalBlockNode, GPMAutomateEditor.Models","nodes":[{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":74,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"d7be2a6c-293e-4845-8d80-24f4c3fd6b40","display_text":null,"raw_input":"[{\"Key\":\"FILE_PATH\",\"Value\":\"D:\\\\Query_id\\\\$fileName.xlsx\"}]","comment":"Tạo file excel"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":71,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"03e5db7d-f716-4086-9060-182a08ff5e85","display_text":null,"raw_input":"[{\"Key\":\"FILE_PATH\",\"Value\":\"D:\\\\Query_id\\\\$fileName.xlsx\"},{\"Key\":\"SHEET_ID\",\"Value\":\"0\"},{\"Key\":\"COL_NAME_OR_INDEX\",\"Value\":\"A\"},{\"Key\":\"DATA\",\"Value\":\"$profileName\"}]","comment":"Ghi profile name"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":71,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"2ed2d762-fc97-4705-823b-1af1afde21eb","display_text":null,"raw_input":"[{\"Key\":\"FILE_PATH\",\"Value\":\"D:\\\\Query_id\\\\$fileName.xlsx\"},{\"Key\":\"SHEET_ID\",\"Value\":\"0\"},{\"Key\":\"COL_NAME_OR_INDEX\",\"Value\":\"B\"},{\"Key\":\"DATA\",\"Value\":\"$src\"}]","comment":"Ghi src app"},{"$type":"GPMAutomateEditor.Models.ActionNode, GPMAutomateEditor.Models","type":71,"element_xpath":null,"output_variable_name":null,"delay":"0,0","id":"f0b01901-be17-4650-90f9-9d60ed36a993","display_text":null,"raw_input":"[{\"Key\":\"FILE_PATH\",\"Value\":\"D:\\\\Query_id\\\\$fileName.xlsx\"},{\"Key\":\"SHEET_ID\",\"Value\":\"0\"},{\"Key\":\"COL_NAME_OR_INDEX\",\"Value\":\"C\"},{\"Key\":\"DATA\",\"Value\":\"$querry_id\"}]","comment":"Ghi querry_id"}],"expanded":true,"id":"e1611057-436e-4e68-9617-18f9a5cfd8ab","display_text":null,"raw_input":null,"comment":"After browser closed"}}